# 画面仕様

## 変更履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.2 | 2025-11-27 | 開始日、終了日を必須項目に変更 |
| 1.1 | 2025-11-27 | 開始日、終了日、進捗状況フィールドを追加。進捗バッジと日付範囲表示を追加 |
| 1.0 | 2024-11-26 | 初版作成 |

## 1. 画面構成

### 1.1 レイアウト概要

```
┌────────────────────────────────────────┐
│              ヘッダー                    │
│         📝 Todo リスト                   │
├────────────────────────────────────────┤
│           統計カード (4つ)               │
│  [合計] [未着手] [進行中] [完了]          │
├────────────────────────────────────────┤
│         タスク作成フォーム               │
│  ┌────────────────────────────────┐    │
│  │ タスク名: [_______________]    │    │
│  │ 詳細説明: [_______________]    │    │
│  │         [➕ タスクを追加]       │    │
│  └────────────────────────────────┘    │
├────────────────────────────────────────┤
│         フィルタータブ                   │
│  [すべて] [未着手] [進行中] [完了]        │
├────────────────────────────────────────┤
│           タスク一覧                     │
│  ┌────────────────────────────────┐    │
│  │ タスクカード #1                 │    │
│  └────────────────────────────────┘    │
│  ┌────────────────────────────────┐    │
│  │ タスクカード #2                 │    │
│  └────────────────────────────────┘    │
└────────────────────────────────────────┘
```

## 2. UI要素

### 2.1 ヘッダー

| 要素 | 内容 |
|------|------|
| タイトル | 📝 Todo リスト |
| サブタイトル | Claude Code レクチャー会 - サンプルアプリケーション |

### 2.2 統計カード

4つのカードで構成。

| カード | 表示内容 | スタイル |
|--------|---------|---------|
| 合計 | 全タスク数 | 紫色 |
| 未着手 | status=TODO の件数 | グレー |
| 進行中 | status=IN_PROGRESS の件数 | 青色 |
| 完了 | status=DONE の件数 | 緑色 |

### 2.3 タスク作成フォーム

| 要素 | ID | type | 属性 |
|------|-----|------|------|
| タスク名入力 | taskTitle | text | required, maxlength="100" |
| 詳細説明入力 | taskDescription | textarea | maxlength="500", rows="3" |
| 開始日入力 | taskStartDate | date | required |
| 終了日入力 | taskEndDate | date | required |
| 進捗選択 | taskProgress | select | - |
| 追加ボタン | - | submit | - |

**進捗選択の選択肢:**
- 0% (value="0")
- 25% (value="25")
- 50% (value="50")
- 75% (value="75")
- 100% (value="100")

### 2.4 フィルタータブ

| タブ | data-filter | 表示テキスト |
|------|-------------|-------------|
| すべて | all | すべて |
| 未着手 | TODO | 未着手 |
| 進行中 | IN_PROGRESS | 進行中 |
| 完了 | DONE | 完了 |

### 2.5 タスクカード

```
┌──────────────────────────────────────────┐
│ タスク名                            #ID  │
├──────────────────────────────────────────┤
│ 詳細説明テキスト                          │
├──────────────────────────────────────────┤
│ [⏸️ 未着手] [50%] 📅 2024/01/01 ~ 2024/01/31 │
│ 📅 作成: 2024/01/01                      │
├──────────────────────────────────────────┤
│ [▶️ 開始する] [✏️ 編集] [🗑️ 削除]       │
└──────────────────────────────────────────┘
```

| 要素 | 説明 |
|------|------|
| タスク名 | title の表示 |
| ID | タスクIDの表示（#1 形式） |
| 詳細説明 | description の表示 |
| ステータスバッジ | 現在のステータスをアイコン付きで表示 |
| 進捗バッジ | progress の値をバッジで表示（0%/25%/50%/75%/100%） |
| 日付範囲 | startDate ~ endDate を YYYY/MM/DD 形式で表示 |
| 作成日 | createdAt の日付（YYYY/MM/DD形式） |
| 更新日 | updatedAt の日付（作成日と異なる場合のみ表示） |
| アクションボタン | ステータス変更、編集、削除 |

**進捗バッジのカラー:**
- 0%: グレー (#94a3b8)
- 25%: 水色 (#3b82f6)
- 50%: 青 (#2563eb)
- 75%: 濃青 (#1d4ed8)
- 100%: 緑 (#10b981)

### 2.6 編集モーダル

```
┌──────────────────────────────────────┐
│ ✏️ タスクを編集                  [×] │
├──────────────────────────────────────┤
│ タスク名: [___________________]      │
│ 詳細説明: [___________________]      │
│ 開始日: [___________________]        │
│ 終了日: [___________________]        │
│ 進捗: [▼ 50%             ]          │
│ ステータス: [▼ 進行中       ]       │
├──────────────────────────────────────┤
│           [キャンセル] [保存]        │
└──────────────────────────────────────┘
```

| 要素 | ID | type |
|------|-----|------|
| タスクID（hidden） | editTaskId | hidden |
| タスク名 | editTaskTitle | text |
| 詳細説明 | editTaskDescription | textarea |
| 開始日 | editTaskStartDate | date |
| 終了日 | editTaskEndDate | date |
| 進捗 | editTaskProgress | select |
| ステータス | editTaskStatus | select |

**進捗とステータスの同期:**
- 進捗を変更すると、ステータスが自動的に更新されます
- ステータスを変更すると、進捗が自動的に更新されます
- 同期ルール:
  - 進捗 0% ↔ ステータス TODO
  - 進捗 25%/50%/75% ↔ ステータス IN_PROGRESS
  - 進捗 100% ↔ ステータス DONE

### 2.7 その他のUI要素

| 要素 | ID | 用途 |
|------|-----|------|
| 空の状態 | emptyState | タスクがない時の表示 |
| ローディング | loading | データ読み込み中の表示 |
| トースト | toast | 通知メッセージ |

## 3. DOM構造

### 3.1 メインコンテナ

| 要素 | class/id | 説明 |
|------|----------|------|
| コンテナ | class="container" | 全体を囲むラッパー要素 |
| ヘッダー | class="header" | タイトル・サブタイトルを含む |
| 統計エリア | class="stats-container" | 4つの統計カードを含む |
| フォームエリア | class="task-form-container" | タスク作成フォームを含む |
| フィルター | class="filter-tabs" | フィルターボタンを含む |
| タスク一覧 | id="taskList", class="task-list" | タスクカードを動的に格納 |
| 空の状態 | id="emptyState", class="empty-state" | タスクがない時に表示 |
| ローディング | id="loading", class="loading" | 読み込み中に表示 |

### 3.2 統計カード

| 要素 | class | id | 内容 |
|------|-------|-----|------|
| カード（合計） | stat-card | - | 全タスク数 |
| 数値（合計） | stat-value | totalCount | 数値を動的表示 |
| ラベル（合計） | stat-label | - | "合計" |
| カード（未着手） | stat-card stat-todo | - | 未着手タスク数 |
| 数値（未着手） | stat-value | todoCount | 数値を動的表示 |
| ラベル（未着手） | stat-label | - | "未着手" |
| カード（進行中） | stat-card stat-progress | - | 進行中タスク数 |
| 数値（進行中） | stat-value | progressCount | 数値を動的表示 |
| ラベル（進行中） | stat-label | - | "進行中" |
| カード（完了） | stat-card stat-done | - | 完了タスク数 |
| 数値（完了） | stat-value | doneCount | 数値を動的表示 |
| ラベル（完了） | stat-label | - | "完了" |

### 3.3 タスクカード（動的生成）

| 要素 | class | 内容 |
|------|-------|------|
| カード本体 | task-card status-{status} | ステータスに応じたクラスを付与 |
| ヘッダー部 | task-header | タイトルとIDを横並び |
| タイトル | task-title | h3要素でタスク名を表示 |
| ID表示 | task-id | #{id}形式で表示 |
| 説明文 | task-description | p要素で詳細説明を表示 |
| メタ情報 | task-meta | バッジと日付を横並び |
| ステータスバッジ | task-status-badge {status} | アイコン+ステータス名 |
| 進捗バッジ | task-progress-badge progress-{value} | 進捗値をバッジで表示（0/25/50/75/100） |
| 日付範囲 | task-date-range | 開始日〜終了日を表示 |
| 日付 | task-date | 作成日・更新日を表示 |
| アクション部 | task-actions | ボタンを横並び |
| ステータスボタン | btn-action btn-status | 次のステータスへ変更 |
| 編集ボタン | btn-action btn-edit | 編集モーダルを開く |
| 削除ボタン | btn-action btn-delete | 削除確認後に削除 |

### 3.4 編集モーダル

| 要素 | class/id | 説明 |
|------|----------|------|
| オーバーレイ | id="editModal", class="modal" | 背景を暗くする |
| コンテンツ | class="modal-content" | モーダル本体 |
| ヘッダー | class="modal-header" | タイトルと閉じるボタン |
| 閉じるボタン | class="modal-close" | ×ボタン |
| フォーム | id="editForm", class="modal-body" | 入力フォーム |
| フッター | class="modal-footer" | キャンセル・保存ボタン |

## 4. ユーザー操作フロー

### 4.1 タスク作成

1. タスク名を入力（必須）
2. 詳細説明を入力（任意）
3. 「タスクを追加」ボタンをクリック
4. POST /api/tasks を呼び出し
5. 成功 → トースト表示、フォームクリア、一覧再読み込み
6. 失敗 → エラートースト表示

### 4.2 ステータス変更

1. タスクカードの「開始する」or「完了する」ボタンをクリック
2. PUT /api/tasks/:id を呼び出し（statusのみ更新）
3. 成功 → トースト表示、一覧再読み込み
4. 失敗 → エラートースト表示

### 4.3 タスク編集

1. タスクカードの「編集」ボタンをクリック
2. 編集モーダルが開く（現在の値がセットされる）
3. 内容を編集
4. 「保存」ボタンをクリック
5. PUT /api/tasks/:id を呼び出し
6. 成功 → モーダルを閉じる、トースト表示、一覧再読み込み
7. 失敗 → エラートースト表示

### 4.4 タスク削除

1. タスクカードの「削除」ボタンをクリック
2. 確認ダイアログ表示
3. 「OK」をクリック
4. DELETE /api/tasks/:id を呼び出し
5. 成功 → トースト表示、一覧再読み込み
6. 失敗 → エラートースト表示

### 4.5 フィルター切り替え

1. フィルタータブをクリック
2. アクティブなタブを切り替え
3. currentFilter を更新
4. フィルター条件に合うタスクのみ表示

## 5. JavaScript関数一覧

| 関数名 | 用途 |
|--------|------|
| loadTasks() | タスク一覧をAPIから取得 |
| renderTasks() | タスク一覧を画面に描画 |
| createTaskCard(task) | タスクカードのHTML生成 |
| handleCreateTask(e) | タスク作成フォームの送信処理 |
| updateStatus(taskId, newStatus) | ステータス更新 |
| deleteTask(taskId) | タスク削除 |
| openEditModal(taskId) | 編集モーダルを開く |
| closeEditModal() | 編集モーダルを閉じる |
| handleUpdateTask(e) | タスク更新フォームの送信処理 |
| filterTasks(filter) | フィルター切り替え |
| updateStats() | 統計情報を更新 |
| showLoading(show) | ローディング表示切り替え |
| showToast(message, type) | トースト通知表示 |
| escapeHtml(text) | HTMLエスケープ |
| getNextStatus(currentStatus) | 次のステータスを取得 |
| getNextStatusText(currentStatus) | 次のステータスボタンテキストを取得 |
| getStatusFromProgress(progress) | 進捗値からステータスを取得 |
| getProgressFromStatus(status) | ステータスから進捗値を取得 |
| formatDateForDisplay(dateString) | 日付を表示用にフォーマット（YYYY/MM/DD） |
| formatDateForInput(dateString) | 日付を入力用にフォーマット（YYYY-MM-DD） |

## 6. グローバル変数

| 変数名 | 型 | 用途 |
|--------|------|------|
| API_BASE_URL | string | APIのベースURL |
| currentFilter | string | 現在のフィルター条件 |
| allTasks | Task[] | 全タスクデータ |
